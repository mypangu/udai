<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="referrer" content="strict-origin-when-cross-origin">
  <meta name="theme-color" content="#4ecdc4">
  <meta name="description" content="Watch Tamil TV shows and videos from multiple channels">
  <title>YouDai Connecting Tamil</title>


  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">
  <link rel="icon" type="image/png" href="/icons/icon-192.png">
  
  <!-- <script src="Dev-shield.js"></script> -->

  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    * {
      box-sizing: border-box;
    }
	
	html, body {
	  touch-action: manipulation;
	}	

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #0c0c0c 0%, #1a1a1a 100%);
      color: #ffffff;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Container */
    .container {
      width: 100%;
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 10px;
    }

    @media (min-width: 768px) {
      .container {
        padding: 0 25px;
      }
    }

    /* Header - Compact on mobile */
    header {
      background: linear-gradient(135deg, #1e1e1e 0%, #2a2a2a 100%);
      padding: 12px 0;
      text-align: center;
      box-shadow: 0 2px 10px rgba(0,0,0,0.3);
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(10px);
    }

    @media (min-width: 768px) {
      header {
        padding: 20px 0;
      }
    }

    header h1 {
      margin: 0;
      font-size: 20px;
      font-weight: 700;
      background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1);
      background-size: 200% 200%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: gradient 3s ease infinite;
    }

    @media (min-width: 768px) {
      header h1 {
        font-size: 28px;
      }
    }

    @keyframes gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Top bar - Compact mobile */
    .top-bar {
      background: rgba(30, 30, 30, 0.9);
      backdrop-filter: blur(10px);
      padding: 8px 0;
      position: sticky;
      top: 56px;
      z-index: 99;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    @media (min-width: 768px) {
      .top-bar {
        padding: 15px 0;
        top: 80px;
      }
    }

    .search-filter-container {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    @media (min-width: 768px) {
      .search-filter-container {
        gap: 15px;
      }
    }

    .search-container {
      position: relative;
      flex: 1;
    }

    .search-input {
      width: 100%;
      padding: 8px 35px 8px 12px;
      border-radius: 20px;
      border: 2px solid transparent;
      background: rgba(255,255,255,0.1);
      color: #fff;
      font-size: 14px;
      outline: none;
      transition: all 0.3s ease;
    }

    @media (min-width: 768px) {
      .search-input {
        padding: 12px 50px 12px 20px;
        font-size: 16px;
        border-radius: 25px;
      }
    }

    .search-input:focus {
      border-color: #4ecdc4;
      background: rgba(255,255,255,0.15);
      box-shadow: 0 0 15px rgba(78, 205, 196, 0.3);
    }

    .search-icon {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: rgba(255,255,255,0.6);
      font-size: 14px;
    }

    @media (min-width: 768px) {
      .search-icon {
        right: 20px;
        font-size: 16px;
      }
    }

    /* Filter controls - Compact mobile */
    .filter-controls {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-shrink: 0;
    }

    .calendar-btn {
      background: rgba(255,255,255,0.1);
      border: none;
      border-radius: 50%;
      width: 35px;
      height: 35px;
      color: #fff;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    @media (min-width: 768px) {
      .calendar-btn {
        width: 45px;
        height: 45px;
        font-size: 18px;
      }
    }

    .calendar-btn:hover, .calendar-btn.active {
      background: #4ecdc4;
      transform: scale(1.1);
    }

    .date-input {
      position: absolute;
      top: 45px;
      right: 0;
      background: rgba(30, 30, 30, 0.95);
      border: 2px solid #4ecdc4;
      border-radius: 8px;
      padding: 8px;
      color: #fff;
      font-size: 12px;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.3);
      z-index: 1000;
      min-width: 150px;
      color-scheme: dark;
    }

    @media (min-width: 768px) {
      .date-input {
        top: 55px;
        border-radius: 12px;
        padding: 12px;
        font-size: 14px;
        min-width: 200px;
      }
    }

    .clear-filters-btn {
      background: linear-gradient(135deg, #ff6b6b, #ee5a5a);
      border: none;
      border-radius: 15px;
      padding: 6px 10px;
      color: white;
      cursor: pointer;
      font-size: 12px;
      font-weight: 500;
      transition: all 0.3s ease;
      white-space: nowrap;
    }

    @media (min-width: 768px) {
      .clear-filters-btn {
        border-radius: 20px;
        padding: 8px 16px;
        font-size: 14px;
      }
    }

    /* Channel sections - Compact mobile layout */
    .channel-sections {
      padding: 15px 0 30px;
    }

    @media (min-width: 768px) {
      .channel-sections {
        padding: 20px 0 40px;
      }
    }

    .channel-section {
      margin-bottom: 15px;
    }

    @media (min-width: 768px) {
      .channel-section {
        margin-bottom: 25px;
      }
    }

    .section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      padding: 0 10px;
    }

    @media (min-width: 768px) {
      .section-header {
        margin-bottom: 20px;
        padding: 0 15px;
      }
    }

    .section-title {
      font-size: 18px;
      font-weight: 700;
      color: #fff;
      margin: 0;
    }

    @media (min-width: 768px) {
      .section-title {
        font-size: 24px;
      }
    }

    .section-expand {
      color: rgba(255,255,255,0.7);
      font-size: 14px;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    /* Horizontal scroll - Compact mobile cards */
    .videos-scroll {
      display: flex;
      gap: 8px;
      overflow-x: auto;
      scroll-behavior: smooth;
      scrollbar-width: none;
      -ms-overflow-style: none;
      padding: 0 10px 15px;
    }

    @media (min-width: 768px) {
      .videos-scroll {
        gap: 15px;
        padding: 0 15px 20px;
      }
    }

    .videos-scroll::-webkit-scrollbar {
      display: none;
    }

    /* Compact mobile video cards */
    .video-card-horizontal {
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
      overflow: hidden;
      cursor: pointer;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.1);
      position: relative;
      flex-shrink: 0;
      width: 140px;
    }

    @media (min-width: 480px) {
      .video-card-horizontal {
        width: 160px;
      }
    }

    @media (min-width: 768px) {
      .video-card-horizontal {
        width: 240px;
        border-radius: 16px;
      }
    }

    @media (min-width: 1024px) {
      .video-card-horizontal {
        width: 280px;
      }
    }

    .video-card-horizontal:hover {
      transform: scale(1.05);
      box-shadow: 0 10px 25px rgba(0,0,0,0.3);
      border-color: rgba(78, 205, 196, 0.5);
    }

    /* Compact thumbnails */
    .card-thumbnail {
      position: relative;
      width: 100%;
      height: 80px;
      overflow: hidden;
    }

    @media (min-width: 480px) {
      .card-thumbnail {
        height: 90px;
      }
    }

    @media (min-width: 768px) {
      .card-thumbnail {
        height: 135px;
      }
    }

    @media (min-width: 1024px) {
      .card-thumbnail {
        height: 160px;
      }
    }

    .card-thumbnail img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .play-overlay {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.7);
      border-radius: 50%;
      width: 35px;
      height: 35px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #4ecdc4;
      font-size: 14px;
      opacity: 0;
      transition: all 0.3s ease;
    }

    @media (min-width: 768px) {
      .play-overlay {
        width: 50px;
        height: 50px;
        font-size: 20px;
      }
    }

    .video-card-horizontal:hover .play-overlay {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1.1);
    }

    /* Compact card content */
    .card-content {
      padding: 8px;
    }

    @media (min-width: 768px) {
      .card-content {
        padding: 16px;
      }
    }

    .card-title {
      font-size: 12px;
      font-weight: 600;
      line-height: 1.3;
      margin: 0 0 4px 0;
      color: #fff;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    @media (min-width: 768px) {
      .card-title {
        font-size: 14px;
        margin: 0 0 8px 0;
        line-height: 1.4;
      }
    }

    .card-meta {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 10px;
      color: rgba(255,255,255,0.6);
    }

    @media (min-width: 768px) {
      .card-meta {
        font-size: 12px;
      }
    }

    /* Grid layout - Compact mobile */
    .video-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
      padding: 15px 10px;
    }

    @media (min-width: 480px) {
      .video-grid {
        gap: 12px;
        padding: 15px;
      }
    }

    @media (min-width: 768px) {
      .video-grid {
        grid-template-columns: repeat(4, 1fr);
        gap: 20px;
        padding: 20px 25px;
      }
    }

    @media (min-width: 1200px) {
      .video-grid {
        grid-template-columns: repeat(5, 1fr);
        gap: 25px;
        padding: 20px 40px;
      }
    }

    /* Grid cards - Compact mobile */
    .video-card-grid {
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
      overflow: hidden;
      cursor: pointer;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.1);
      position: relative;
    }

    @media (min-width: 768px) {
      .video-card-grid {
        border-radius: 16px;
      }
    }

    .video-card-grid:hover {
      transform: translateY(-4px) scale(1.02);
      box-shadow: 0 10px 25px rgba(0,0,0,0.3);
      border-color: rgba(78, 205, 196, 0.5);
    }

    @media (min-width: 768px) {
      .video-card-grid:hover {
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 20px 40px rgba(0,0,0,0.3);
      }
    }

    /* Grid thumbnails */
    .video-card-grid .card-thumbnail {
      aspect-ratio: 16 / 9;
      height: auto;
    }

    .channel-tag {
      position: absolute;
      top: 6px;
      right: 6px;
      background: rgba(0,0,0,0.8);
      color: #4ecdc4;
      padding: 3px 6px;
      border-radius: 8px;
      font-size: 10px;
      font-weight: 600;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(78, 205, 196, 0.3);
    }

    @media (min-width: 768px) {
      .channel-tag {
        top: 8px;
        right: 8px;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 12px;
      }
    }

    /* Loading animation */
    .loading {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: #4ecdc4;
      animation: spin 1s ease-in-out infinite;
    }

    @media (min-width: 768px) {
      .loading {
        width: 20px;
        height: 20px;
        border: 3px solid rgba(255,255,255,0.3);
      }
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* No results - Compact */
    .no-results {
      text-align: center;
      padding: 40px 15px;
      color: rgba(255,255,255,0.6);
    }

    @media (min-width: 768px) {
      .no-results {
        padding: 60px 20px;
      }
    }

    .no-results i {
      font-size: 48px;
      margin-bottom: 15px;
      color: rgba(255,255,255,0.3);
    }

    @media (min-width: 768px) {
      .no-results i {
        font-size: 64px;
        margin-bottom: 20px;
      }
    }

    .no-results h3 {
      font-size: 18px;
      margin: 0 0 8px 0;
      color: rgba(255,255,255,0.8);
    }

    @media (min-width: 768px) {
      .no-results h3 {
        font-size: 24px;
        margin: 0 0 10px 0;
      }
    }

    .no-results p {
      font-size: 14px;
      margin: 0;
    }

    @media (min-width: 768px) {
      .no-results p {
        font-size: 16px;
      }
    }

    /* Back button */
    .back-home-btn {
      background: rgba(255,255,255,0.1);
      border: none;
      border-radius: 15px;
      padding: 6px 12px;
      color: #fff;
      cursor: pointer;
      font-size: 12px;
      font-weight: 500;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    @media (min-width: 768px) {
      .back-home-btn {
        border-radius: 20px;
        padding: 8px 16px;
        font-size: 14px;
        gap: 8px;
      }
    }

    /* Go to top - Compact mobile */
    .go-to-top {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: linear-gradient(135deg, #4ecdc4, #45b7d1);
      border: none;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      color: white;
      font-size: 16px;
      cursor: pointer;
      z-index: 1000;
      transition: all 0.3s ease;
      opacity: 0;
      visibility: hidden;
      transform: scale(0.8);
      box-shadow: 0 4px 15px rgba(78, 205, 196, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    @media (min-width: 768px) {
      .go-to-top {
        bottom: 30px;
        right: 30px;
        width: 55px;
        height: 55px;
        font-size: 20px;
        box-shadow: 0 4px 20px rgba(78, 205, 196, 0.3);
      }
    }

    .go-to-top.visible {
      opacity: 1;
      visibility: visible;
      transform: scale(1);
    }

    .go-to-top:hover {
      background: linear-gradient(135deg, #45b7d1, #4ecdc4);
      transform: scale(1.1);
    }

    /* Grid headers */
    .grid-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin: 25px 0 15px 0;
      padding: 0 10px;
    }

    @media (min-width: 768px) {
      .grid-header {
        margin: 40px 0 20px 0;
        padding: 0 25px;
      }
    }

    /* Hidden utility */
    .hidden {
      display: none!important;
    }

    /* Scroll buttons - Hidden on mobile for performance */
    .scroll-btn {
      display: none;
    }

    @media (min-width: 768px) {
      .scroll-btn {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background: rgba(0,0,0,0.8);
        border: none;
        border-radius: 50%;
        width: 45px;
        height: 45px;
        color: #fff;
        font-size: 18px;
        cursor: pointer;
        z-index: 10;
        transition: all 0.3s ease;
      }

      .scroll-btn:hover {
        background: rgba(78, 205, 196, 0.9);
        transform: translateY(-50%) scale(1.1);
      }

      .scroll-btn.left {
        left: 10px;
      }

      .scroll-btn.right {
        right: 10px;
      }

      .videos-container:hover .scroll-btn {
        display: flex;
        align-items: center;
        justify-content: center;
      }
    }

    /* Optimize scrollbars */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255,255,255,0.05);
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(78, 205, 196, 0.4);
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(78, 205, 196, 0.6);
    }

    @media (min-width: 768px) {
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }

      ::-webkit-scrollbar-track {
        background: rgba(255,255,255,0.1);
      }

      ::-webkit-scrollbar-thumb {
        background: rgba(78, 205, 196, 0.6);
        border-radius: 4px;
      }
    }

    /* Loading state */
    .loading-state {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px 20px;
      color: rgba(255,255,255,0.7);
      gap: 10px;
    }

    /* Error state */
    .error-state {
      text-align: center;
      padding: 40px 20px;
      color: rgba(255, 107, 107, 0.8);
    }

    .error-state i {
      font-size: 48px;
      margin-bottom: 15px;
    }

    .error-state h3 {
      font-size: 18px;
      margin: 0 0 8px 0;
    }

    .error-state p {
      font-size: 14px;
      margin: 0;
      opacity: 0.8;
    }
	
	/* Scroll buttons - Hidden on mobile for performance */
.scroll-btn {
  display: none;
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(0,0,0,0.8);
  border: none;
  border-radius: 50%;
  width: 45px;
  height: 45px;
  color: #fff;
  font-size: 18px;
  cursor: pointer;
  z-index: 10;
  transition: all 0.3s ease;
  align-items: center;
  justify-content: center;
}

@media (min-width: 768px) {
  .scroll-btn {
    display: flex;
  }

  .scroll-btn:hover {
    background: rgba(78, 205, 196, 0.9);
    transform: translateY(-50%) scale(1.1);
  }

  .scroll-btn.left {
    left: -22px;
  }

  .scroll-btn.right {
    right: -22px;
  }

  .videos-container {
    position: relative;
  }

  .videos-container:hover .scroll-btn {
    opacity: 1;
  }

  .scroll-btn {
    opacity: 0;
    transition: opacity 0.3s ease, transform 0.3s ease;
  }
}
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1>ðŸŽ¬ YouDai</h1>
    </div>
  </header>

  <div class="top-bar">
    <div class="container">
      <div class="search-filter-container">
        <div class="search-container">
          <input type="text" id="searchBox" class="search-input" placeholder="Search videos...">
          <i class="fas fa-search search-icon"></i>
        </div>
        
        <div class="filter-controls">
          <div class="date-filter-container">
            <button class="calendar-btn" id="calendarBtn">
              <i class="fas fa-calendar-alt"></i>
            </button>
            <input type="date" id="dateFilter" class="date-input" style="display: none;">
          </div>
          <button class="clear-filters-btn" id="clearFilters" style="display: none;">
            <i class="fas fa-times"></i> Clear
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <!-- Loading state -->
    <div class="loading-state" id="loadingState">
      <div class="loading"></div>
      <span>Loading videos...</span>
    </div>

    <!-- Error state -->
    <div class="error-state hidden" id="errorState">
      <i class="fas fa-exclamation-triangle"></i>
      <h3>Failed to load videos</h3>
      <p>Please check your connection and try again</p>
      <button onclick="window.location.reload()" style="margin-top: 15px; padding: 8px 16px; background: #4ecdc4; border: none; border-radius: 20px; color: white; cursor: pointer;">Retry</button>
    </div>

    <!-- Channel sections view -->
    <div class="channel-sections hidden" id="channelSections"></div>
    
    <!-- Grid view for single channel -->
    <div class="video-grid-container hidden" id="videoGridContainer">
      <div class="grid-header">
        <h2 class="section-title" id="gridTitle"></h2>
        <button class="back-home-btn" id="backButton">
          <i class="fas fa-home"></i> Back Home
        </button>
      </div>
      <div class="video-grid" id="videoGrid"></div>
    </div>
    
    <!-- Search results -->
    <div class="search-results hidden" id="searchResults">
      <h2 class="section-title" id="searchTitle">Search Results</h2>
      <div class="video-grid" id="searchGrid"></div>
    </div>
  </div>

  <!-- Go to Top Button -->
  <button class="go-to-top" id="goToTopBtn">
    <i class="fas fa-chevron-up"></i>
  </button>
<!--
<script disable-devtool-auto='true'
src='https://cdn.jsdelivr.net/npm/disable-devtool'
clear-log='true'
disable-select='true' 
disable-copy='true'
disable-cut='true' 
disable-paste='false'>
</script>  -->

  <script>
    let videos = [];
    let isLoading = false;

    // DOM elements
    const elements = {
      loadingState: document.getElementById("loadingState"),
      errorState: document.getElementById("errorState"),
      channelSections: document.getElementById("channelSections"),
      videoGridContainer: document.getElementById("videoGridContainer"),
      videoGrid: document.getElementById("videoGrid"),
      searchResults: document.getElementById("searchResults"),
      searchGrid: document.getElementById("searchGrid"),
      searchBox: document.getElementById("searchBox"),
      calendarBtn: document.getElementById("calendarBtn"),
      dateFilter: document.getElementById("dateFilter"),
      clearFilters: document.getElementById("clearFilters"),
      backButton: document.getElementById("backButton"),
      gridTitle: document.getElementById("gridTitle"),
      searchTitle: document.getElementById("searchTitle"),
      goToTopBtn: document.getElementById("goToTopBtn")
    };

    let currentView = 'loading';
    let currentChannel = null;
    let isDatePickerVisible = false;

    // Initialize the app
    async function init() {
      registerServiceWorker();
      await loadVideos();
      setupEventListeners();
    }

    // Register service worker for PWA
    async function registerServiceWorker() {
      if ('serviceWorker' in navigator) {
        try {
          const registration = await navigator.serviceWorker.register('/service-worker.js');
          console.log('SW registered:', registration);
        } catch (error) {
          console.log('SW registration failed:', error);
        }
      }
    }

    // Load videos from external JSON
    async function loadVideos() {
      if (isLoading) return;
      isLoading = true;
      
      showLoadingState();
      
      try {
        const response = await fetch('/videos.json');
        if (!response.ok) throw new Error('Network response was not ok');
        
        videos = await response.json();
        
        if (!Array.isArray(videos) || videos.length === 0) {
          throw new Error('Invalid video data');
        }

        hideLoadingState();
        renderChannelSections();
        showView('sections');
      } catch (error) {
        console.error('Failed to load videos:', error);
        showErrorState();
      } finally {
        isLoading = false;
      }
    }

    // State management
    function showLoadingState() {
      elements.loadingState.classList.remove('hidden');
      elements.errorState.classList.add('hidden');
      elements.channelSections.classList.add('hidden');
      elements.videoGridContainer.classList.add('hidden');
      elements.searchResults.classList.add('hidden');
    }

    function hideLoadingState() {
      elements.loadingState.classList.add('hidden');
    }

    function showErrorState() {
      elements.errorState.classList.remove('hidden');
      elements.loadingState.classList.add('hidden');
      elements.channelSections.classList.add('hidden');
      elements.videoGridContainer.classList.add('hidden');
      elements.searchResults.classList.add('hidden');
    }

    // Event listeners
    function setupEventListeners() {
      elements.searchBox.addEventListener("input", debounce(handleSearch, 300));
      elements.dateFilter.addEventListener("change", handleSearch);
      elements.clearFilters.addEventListener("click", clearAllFilters);
      elements.calendarBtn.addEventListener("click", toggleDatePicker);
      elements.backButton.addEventListener("click", backToSections);
      elements.goToTopBtn.addEventListener("click", scrollToTop);
      
      window.addEventListener("scroll", throttle(handleScroll, 100));
      document.addEventListener("click", handleOutsideClick);
      document.addEventListener("keydown", handleKeyDown);
      window.addEventListener("orientationchange", handleOrientationChange);
    }

    // Utility functions
    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }

    function throttle(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        if (!timeout) {
          timeout = setTimeout(() => {
            timeout = null;
            func(...args);
          }, wait);
        }
      };
    }

    function getOptimalThumbnail(video) {
      return window.innerWidth < 768 ? video.mthumb : video.dthumb;
    }

    function formatDate(dateString) {
      const date = new Date(dateString);
      return date.toLocaleDateString('en-IN', { 
        day: 'numeric', 
        month: 'short',
        year: 'numeric'
      });
    }

    function sortVideosByDate(videos) {
      return [...videos].sort((a, b) => new Date(b.date) - new Date(a.date));
    }

    // Event handlers
    function handleOutsideClick(e) {
      if (!e.target.closest('.date-filter-container')) {
        hideDatePicker();
      }
    }

    function handleKeyDown(e) {
      if (e.key === "Escape" && isDatePickerVisible) {
        hideDatePicker();
      }
    }

    function handleOrientationChange() {
      setTimeout(() => {
        if (currentView === 'sections') {
          renderChannelSections();
        }
      }, 100);
    }

    // Scroll functionality
    function scrollToTop() {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    }

    function handleScroll() {
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      elements.goToTopBtn.classList.toggle('visible', scrollTop > 300);
    }

    // Date picker functions
    function toggleDatePicker() {
      isDatePickerVisible ? hideDatePicker() : showDatePicker();
    }

    function showDatePicker() {
      elements.dateFilter.style.display = 'block';
      elements.calendarBtn.classList.add('active');
      isDatePickerVisible = true;
      setTimeout(() => elements.dateFilter.focus(), 100);
    }

    function hideDatePicker() {
      elements.dateFilter.style.display = 'none';
      elements.calendarBtn.classList.remove('active');
      isDatePickerVisible = false;
    }

    // Search and filter functions
    function handleSearch() {
      const query = elements.searchBox.value.toLowerCase().trim();
      const dateVal = elements.dateFilter.value;
      
      if (!query && !dateVal) {
        backToSections();
        return;
      }

      let filtered = videos;

      if (query) {
        filtered = filtered.filter(v => 
          v.title.toLowerCase().includes(query) ||
          v.channel.toLowerCase().includes(query)
        );
      }

      if (dateVal) {
        filtered = filtered.filter(v => v.date === dateVal);
        hideDatePicker();
      }

      elements.clearFilters.style.display = 'block';
      showSearchResults(filtered, query, dateVal);
    }

    function clearAllFilters() {
      elements.searchBox.value = '';
      elements.dateFilter.value = '';
      elements.clearFilters.style.display = 'none';
      hideDatePicker();
      backToSections();
    }

    // View management
    function showView(view) {
      // Hide loading and error states first
      //elements.loadingState.classList.add('hidden');
      //elements.errorState.classList.add('hidden');
      
      // Then manage main views
      elements.channelSections.classList.toggle('hidden', view !== 'sections');
      elements.videoGridContainer.classList.toggle('hidden', view !== 'grid');
      elements.searchResults.classList.toggle('hidden', view !== 'search');
      currentView = view;
    }

    function backToSections() {
      showView('sections');
      currentChannel = null;
      scrollToTop();
    }

    function showChannelGrid(channel) {
      const channelVideos = videos.filter(v => v.channel === channel);
      const sortedVideos = sortVideosByDate(channelVideos);
      elements.gridTitle.textContent = (channel === "Live TV" || channel === "TAMIL DUB Movies" || channel === "Horror Movies" || channel === "Fantasy & Adventure Movies" || channel === "All time Classic Movies" || channel === "Family Movies" || channel === "Comedy Movies" || channel === "" || channel === "Suspense & Thriller Movies" || channel === "Drama Movies" || channel === "Romantic Movies" || channel === "Action Movies" || channel === "Super Hit Cinema") ? channel : `${channel} Shows`;
      renderVideoGrid(sortedVideos, elements.videoGrid, false);
      currentChannel = channel;
      showView('grid');
      scrollToTop();
    }

    function showSearchResults(filteredVideos, query, dateVal) {
      let title = 'Search Results';
      if (query && dateVal) {
        title = `Results for "${query}" on ${formatDate(dateVal)}`;
      } else if (query) {
        title = `Results for "${query}"`;
      } else if (dateVal) {
        title = `Videos from ${formatDate(dateVal)}`;
      }
      
      elements.searchTitle.textContent = title;
      const sortedResults = sortVideosByDate(filteredVideos);
      renderVideoGrid(sortedResults, elements.searchGrid, true);
      showView('search');
      scrollToTop();
    }

    // Navigation
function openPlayer(platform, videoId, video) {
  const playerData = {
    platform: platform,
    id: videoId,
    title: video.title,
    channel: video.channel,
    date: video.date,
    dthumb: video.dthumb,
    mthumb: video.mthumb
  };
  
  try {
    sessionStorage.setItem('currentVideo', JSON.stringify(playerData));
    sessionStorage.setItem('allVideos', JSON.stringify(videos));
    // Redirect to ads page instead of player
    window.location.href = `player.html`;
  } catch (e) {
    // Fallback if sessionStorage fails
    console.warn('SessionStorage not available, using URL parameters');
    const params = new URLSearchParams({
      platform: platform,
      id: videoId,
      title: video.title,
      channel: video.channel
    });
    window.location.href = `player.html?${params.toString()}`;
  }
}

// Rendering functions
function renderChannelSections() {
  if (!videos.length) return;

  const channelOrder = ['Live TV', 'VIJAY TV', 'ZEETAMIL TV', 'SUN TV', 'THANTHI ONE', 'JAYA TV', 'KALAIGNAR TV', 'TAMIL DUB Movies'];
  const allChannels = [...new Set(videos.map(v => v.channel))];
  
  const orderedChannels = [
    ...channelOrder.filter(channel => allChannels.includes(channel)),
    ...allChannels.filter(channel => !channelOrder.includes(channel))
  ];
  
  const sectionsHTML = orderedChannels.map(channel => {
    const channelVideos = videos.filter(v => v.channel === channel);
    const sortedChannelVideos = sortVideosByDate(channelVideos);
    const limitedVideos = sortedChannelVideos.slice(0, 15); // Only show first 12
    const channelId = channel.replace(/\s+/g, '');
    
    return `
      <div class="channel-section" data-channel="${channel}">
        <div class="section-header">
          <h2 class="section-title">${(channel === "Live TV" || channel === "TAMIL DUB Movies" || channel === "Horror Movies" || channel === "Fantasy & Adventure Movies" || channel === "All time Classic Movies" || channel === "Family Movies" || channel === "Comedy Movies" || channel === "" || channel === "Suspense & Thriller Movies" || channel === "Drama Movies" || channel === "Romantic Movies" || channel === "Action Movies" || channel === "Super Hit Cinema") ? channel : channel + " Shows"}</h2>
          <div class="section-actions">
            <span class="section-expand" onclick="showChannelGrid('${channel}')">
              <span>View All</span>
              <i class="fas fa-chevron-right"></i>
            </span>
          </div>
        </div>
        <div class="videos-container">
			<button class="scroll-btn left" onclick="scrollSection('${channelId}', 'left')">
				<i class="fas fa-chevron-left"></i>
			</button>
			<div class="videos-scroll" id="scroll-${channelId}">
				${limitedVideos.map(video => `
					<div class="video-card-horizontal" data-platform="${video.platform}" data-id="${video.id}">
						<div class="card-thumbnail">
							<img src="${getOptimalThumbnail(video)}" alt="${video.title}" loading="lazy" onerror="handleImageError(this)">
							<div class="play-overlay">
								<i class="fas fa-play"></i>
							</div>
						</div>
						<div class="card-content">
							<h3 class="card-title">${video.title}</h3>
							<div class="card-meta">
								<span class="card-date">${formatDate(video.date)}</span>
							</div>
						</div>
					</div>
				`).join('')}
			</div>
			<button class="scroll-btn right" onclick="scrollSection('${channelId}', 'right')">
				<i class="fas fa-chevron-right"></i>
			</button>
		</div>
      </div>
    `;
  }).join('');

  elements.channelSections.innerHTML = sectionsHTML;
  attachVideoCardListeners(elements.channelSections, '.video-card-horizontal');
}

    function renderVideoGrid(videoList, container, showChannelTags) {
      if (videoList.length === 0) {
        container.innerHTML = `
          <div class="no-results" style="grid-column: 1 / -1;">
            <i class="fas fa-search"></i>
            <h3>No videos found</h3>
            <p>Try adjusting your search criteria or filters</p>
          </div>
        `;
        return;
      }

      container.innerHTML = videoList.map(video => `
        <div class="video-card-grid" data-platform="${video.platform}" data-id="${video.id}">
          <div class="card-thumbnail">
            <img src="${getOptimalThumbnail(video)}" alt="${video.title}" loading="lazy" onerror="handleImageError(this)">
            ${showChannelTags ? `<span class="channel-tag">${video.channel}</span>` : ''}
            <div class="play-overlay">
              <i class="fas fa-play"></i>
            </div>
          </div>
          <div class="card-content">
            <h3 class="card-title">${video.title}</h3>
            <div class="card-meta">
              <span class="card-date">${formatDate(video.date)}</span>
            </div>
          </div>
        </div>
      `).join('');

      attachVideoCardListeners(container, '.video-card-grid');
    }

    function attachVideoCardListeners(container, selector) {
      // Use event delegation for better performance
      container.addEventListener('click', (e) => {
        const card = e.target.closest(selector);
        if (!card) return;
        
        e.preventDefault();
        const platform = card.dataset.platform;
        const id = card.dataset.id;
        const video = videos.find(v => v.platform === platform && v.id === id);
        
        if (video) {
          openPlayer(platform, id, video);
        }
      });
    }

    // Error handling
    window.handleImageError = function(img) {
      img.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQwIiBoZWlnaHQ9IjE4MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMzMzIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIEltYWdlPC90ZXh0Pjwvc3ZnPgo=';
      img.alt = 'No thumbnail available';
    };

    // Global functions for onclick handlers
    window.showChannelGrid = showChannelGrid;
    window.loadVideos = loadVideos;

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }

    // Handle window resize with debouncing
    let resizeTimeout;
    window.addEventListener('resize', () => {
      clearTimeout(resizeTimeout);
      resizeTimeout = setTimeout(() => {
        if (currentView === 'sections' && videos.length) {
          renderChannelSections();
        }
      }, 250);
    });
	
	
	// Scroll section function for PC navigation
function scrollSection(channelId, direction) {
  const scrollContainer = document.getElementById(`scroll-${channelId}`);
  if (!scrollContainer) return;
  
  const scrollAmount = window.innerWidth < 1024 ? 300 : 900;
  const currentScroll = scrollContainer.scrollLeft;
  
  if (direction === 'left') {
    scrollContainer.scrollTo({
      left: currentScroll - scrollAmount,
      behavior: 'smooth'
    });
  } else {
    scrollContainer.scrollTo({
      left: currentScroll + scrollAmount,
      behavior: 'smooth'
    });
  }
}

// Make it globally accessible
window.scrollSection = scrollSection;
  </script>
</body>
</html>